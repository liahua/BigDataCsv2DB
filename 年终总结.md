# 2022年度年终总结

在2022年度，我主要负责市场风险日常运维，债警通运维及报表相关工作。

* 技改方向
  * Murex大版本升级：通过后端服务进行数据库埋点构建，保证整个迁移验证过程中逻辑一致，并提供可视化视图分析跑批链条间的关系。
  * 数据地图：提供数据地图模型，更好地分析数据流向及关系，提高数据分析效率。
  * 组内wiki：建立了组内wiki，方便团队成员查询相关文档和信息。
  * 债警通迁移及技术改造：对债警通进行了SPARK分布式计算改造，优化了原有性能，并对数据同步工具进行优化。
  * 其他技改项目：在其他技改项目中，我贡献了2个issue，并提供了相应的fix方案。
* 业务方向
  * 我的主页：协助开发了我的主页功能，方便用户查看个人信息及相关业务
  * 境外分行限额管理项目：负责境外分行限额管理项目的开发和测试，确保项目顺利上线。
  * 理财产品风险画像：参与理财产品风险画像项目的开发，提供风险评估报告，为业务老师提供更好的风险预警。
  * 市场风险大屏：负责市场风险大屏的运维和维护，保证数据的实时性和准确性。
* 团队指标方向
  * 错误码：通过收集和分析错误码，提高团队的质量和效率。
  * dbStack对接：完成了dbStack的对接，提高了团队的开发效率。
  * kafka及redis迁移：负责kafka和redis的迁移工作，确保数据安全性和可用性。
* 日常运维：维护和升级日常运维系统，保证系统的稳定性和可用性。


#### murex大版本升级

##### 构建工具

在M迁移的过程中，通过RMA，MRMP等后端跑批等后端服务进行数据库埋点构建一整套跑批链条的接口-库-表之间的联系，
保证整个迁移验证过程中逻辑一致，并提供可视化视图分析跑批链条间的关系。

##### 对外输出

在工具的构建过程中，为ZA21团队贡献2个issue，并提供相应的fix方案

#### 债警通迁移及技术改造

##### 性能优化

1. 将原有单机债警通进行SPARK分布式计算改造优化原有性能
2. 数据同步工具优化
    1. 添加客户端熔断机制
    2. 分布式任务分发改造，提高系统负载
    3. 针对数据同步特性进行了JVM相关调优解决了95%场景下OOM以及任务跑飞问题

#### 其他技改项目

1. 完成业务网，办公网双网一号通对接及门户登录

#### 我的主页

1. 基于ws构建的事件推送体系提升系统易用性，实现待办任务，风险提示及时推送。
2. 依托切面编程，对各推送子系统0污染
3. **依托TTL技术实现跨线程间信息传递**，解决跨线程间信息不共享的痛点难点，同时对Werk公共包(psf)角色信息数据进行了**动态替换**


#### 市场风险大屏

1. 实现注解字面值动态替换，以保证应用不重启，数据推送速率可调
2. 依托进程内事件驱动及代理，解耦指标阈值触发与事件触发，提高系统性能
4. 完成ws基于用户信息的单点广播推送，实现消息实时可达


#### 错误码改造

1. 由于GATEWAY Flux架构特殊性，通过BeanDef注册替换ZA21原生错误码webFluxServerSpanDecorator处理器完成gateway错误码对接处理
2. 通过边界异常处理，请求头修改快速完成存量系统错误码对接

#### Kafka对接及redis迁移

1. 解决Kafka迁移至共享集群后的接入SpringCloudBus系统宕机异常及无法动态更新问题，同时实现生产0污染

#### 日常运维

1. 针对ACS240S问题，提供一套基于七层负载TCP续传的解决方案并已通过tcp抓包验证通过。
   该方案通过修改docker namespace级tcp.ipv4.keepalive完成streamTcp心跳传输。但是由于行内K8S容器平台开发室相关规定，该方案被拒绝。


### 目前在做

债警通CK迁移及相关降级方案

1. 改造原有CK团队提供的JDBC，依托JVM类加载机制进行JDBC改造，保证现有Sb+Mybatis架构可用 done
2. 依托Mybatis拦截器进行CK降级处理路由分发及SQL动态变更，降低原有代码污染及改造成本 doing

### 不足及未来展望

#### 未来展望

1. 由于三组报表工作特性，期望2023年完成ETL整体构建，结合SEELE及CK平台完成离线ETL与在线ETL工具链打通，指标库迁移工具构建完成指标库全链条由OLTP向OLAP转型。
2. 完成CANAL-ES-CANVAS工具链打通，降低前端报表制作压力.


#### 不足

1. 技术无广度也更难提深度。计划未来一年内，完成后端八股学习以及算法相关学习（八股并不是完全造火箭，不要等真正需要造火箭时才追悔墨迹）。提升对MYSQL理解，减轻运维压力不至于出问题到处求人。
2. 本年度由于算法相关理解欠缺导致风险大屏项目无法真正实现多分行分组随机轮播，技术阻碍了业务发展
3. 本年度由于MYSQL技术深度欠缺导致无法即使解决或从根本解决金市风险跑批运维问题。
4. 业务理解不深入，大多数需求都需仰仗数仓同事们兜底。